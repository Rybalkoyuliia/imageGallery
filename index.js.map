{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst list = document.querySelector('.img-list');\nconst loadMore = document.querySelector('.load-more-btn');\n\nexport default function renderMarkup(arr) {\n  if (arr.hits.length > 0) {\n    const markup = arr.hits\n      .map(\n        img => `<li class=\"img-item\">\n        <div class=\"gallery\">\n        <a href=${img.largeImageURL}><img class=\"img\" src=${img.webformatURL} alt=${img.tags}/></a></div>\n        <ul class=\"img-descr-list\">\n        <li class=\"img-descr-item\"><h4 class=\"descr-name\">Likes</h4><p class=\"descr-value\">${img.likes}</p></li>\n        <li class=\"img-descr-item\"><h4 class=\"descr-name\">Views</h4><p class=\"descr-value\">${img.views}</p></li>\n        <li class=\"img-descr-item\"><h4 class=\"descr-name\">Comments</h4><p class=\"descr-value\">${img.comments}</p></li>\n        <li class=\"img-descr-item\"><h4 class=\"descr-name\">Downloads</h4><p class=\"descr-value\">${img.downloads}</p></li>\n        </ul>\n      </li>`\n      )\n      .join('');\n    list.insertAdjacentHTML('beforeend', markup);\n\n    new SimpleLightbox('.gallery a', {\n      captionDelay: 250,\n    });\n  } else {\n    loadMore.classList.add('hiddent');\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n    list.innerHTML = '';\n  }\n}\n","import renderMarkup from './render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nlet totalImg = 0;\n\nexport default async function fetchImages(searchWord, page) {\n  axios.defaults.baseURL = 'https://pixabay.com/api';\n  try {\n    const response = await axios.get('/', {\n      params: {\n        key: '42078504-06c0bc861c70afe486d8727f6',\n        q: searchWord,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 40,\n      },\n    });\n    renderMarkup(response.data);\n    totalImg = response.data.totalHits;\n    return response.data;\n  } catch (error) {\n    iziToast.error({ message: error.message });\n  }\n}\n// hell\n// const BASE_URL = 'https://pixabay.com/api/';\n// const PARAMS = new URLSearchParams({\n//   key: '42078504-06c0bc861c70afe486d8727f6',\n//   q: searchWord,\n//   image_type: 'photo',\n//   orientation: 'horizontal',\n//   safesearch: true,\n// });\n// const URL = `${BASE_URL}?${PARAMS}`;\n// fetch(URL)\n//   .then(response => response.json())\n// .then(data => renderMarkup(data))\n// .catch(error =>\n//   iziToast.error({\n//     message: error.name,\n//   })\n// );\n// }\n\nexport { totalImg };\n","import fetchImages from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { totalImg } from './js/pixabay-api';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  list: document.querySelector('.img-list'),\n  loader: document.querySelector('.loader-container'),\n  loadMore: document.querySelector('.load-more-btn'),\n  scrollUp: document.querySelector('.scroll-up-btn'),\n};\n\nlet page = 1;\nlet totalPages = 1;\nlet wordToSearch = '';\nlet elem = 0;\n\nrefs.loader.classList.add('hidden');\nrefs.loadMore.classList.add('hidden');\n\nrefs.form.addEventListener('submit', onFormSubmit);\n\nfunction onFormSubmit(event) {\n  event.preventDefault();\n  refs.loadMore.classList.add('hidden');\n  refs.loader.classList.remove('hidden');\n  wordToSearch = event.target.elements.search.value.trim();\n\n  if (!wordToSearch) {\n    iziToast.error({\n      message: 'Sorry, searchfield can not be empty. Please, try again!',\n    });\n    refs.loadMore.classList.add('hidden');\n    refs.list.innerHTML = '';\n    refs.loader.classList.add('hidden');\n    return;\n  } else {\n    fetchImages(wordToSearch, page).finally(() => {\n      totalPages = Math.ceil(totalImg / 40);\n      refs.loader.classList.add('hidden');\n      totalPages > 1\n        ? refs.loadMore.classList.remove('hidden')\n        : refs.loadMore.classList.add('hidden');\n    });\n  }\n  refs.form.reset();\n  refs.list.innerHTML = '';\n}\n\nrefs.loadMore.addEventListener('click', handleLoadMore);\n\nfunction handleLoadMore() {\n  refs.loader.classList.remove('hidden');\n  refs.loadMore.classList.add('hidden');\n\n  page++;\n\n  fetchImages(wordToSearch, page).finally(() => {\n    refs.loader.classList.add('hidden');\n    refs.loadMore.classList.remove('hidden');\n    elem = document.querySelector('.img-item').getBoundingClientRect();\n    let height = Math.floor(elem.height) * 2;\n    window.scrollBy({\n      top: height,\n      left: 0,\n      behavior: 'smooth',\n    });\n    if (page === totalPages || totalImg < 40) {\n      refs.loadMore.classList.add('hidden');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  });\n}\n\nrefs.scrollUp.addEventListener('click', handleScrollClick);\n\nfunction handleScrollClick() {\n  window.scroll({\n    top: 0,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\ndocument.addEventListener('scroll', onScroll);\n\nfunction onScroll(event) {\n  console.log(window.scrollY);\n  console.log(window.innerHeight);\n  window.scrollY < window.innerHeight\n    ? refs.scrollUp.classList.add('hidden')\n    : refs.scrollUp.classList.remove('hidden');\n}\n"],"names":["list","loadMore","renderMarkup","arr","markup","img","SimpleLightbox","iziToast","totalImg","fetchImages","searchWord","page","axios","response","error","refs","totalPages","wordToSearch","elem","onFormSubmit","event","handleLoadMore","height","handleScrollClick","onScroll"],"mappings":"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"}